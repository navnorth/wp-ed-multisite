/*!
 * vimeo.ga.js | v0.7
 * Based on modifications by LukasBeaton (https://github.com/LukasBeaton/vimeo.ga.js)
 * Copyright (c) 2015 Sander Heilbron (http://www.sanderheilbron.nl)
 * MIT licensed
 */

var vimeoGAJS=window.vimeoGAJS?window.vimeoGAJS:{};!function(a){vimeoGAJS={iframes:[],gaTracker:void 0,eventMarker:{},init:function(){vimeoGAJS.iframes=a("iframe"),a.each(vimeoGAJS.iframes,function(b,c){var d=a(c).attr("id");vimeoGAJS.eventMarker[d]={progress25:!1,progress50:!1,progress75:!1,videoPlayed:!1,videoPaused:!1,videoResumed:!1,videoSeeking:!1,videoCompleted:!1,timePercentComplete:0}}),"function"==typeof ga&&(vimeoGAJS.gaTracker="ua"),"undefined"!=typeof _gaq&&"function"==typeof _gaq.push&&(vimeoGAJS.gaTracker="ga"),"undefined"!=typeof dataLayer&&"function"==typeof dataLayer.push&&(vimeoGAJS.gaTracker="gtm"),window.addEventListener?window.addEventListener("message",vimeoGAJS.onMessageReceived,!1):window.attachEvent("onmessage",vimeoGAJS.onMessageReceived,!1)},onMessageReceived:function(b){if("http://player.vimeo.com"===b.origin.replace("https:","http:")&&"undefined"!=typeof vimeoGAJS.gaTracker){var c=JSON.parse(b.data),d=a("#"+c.player_id),e=d.attr("id");switch(c.event){case"ready":vimeoGAJS.onReady();break;case"playProgress":vimeoGAJS.onPlayProgress(c.data,d);break;case"seek":d.data("seek")&&!vimeoGAJS.eventMarker[e].videoSeeking&&(vimeoGAJS.sendEvent(d,"Skipped video forward or backward"),vimeoGAJS.eventMarker[e].videoSeeking=!0);break;case"play":vimeoGAJS.eventMarker[e].videoPlayed?!vimeoGAJS.eventMarker[e].videoResumed&&vimeoGAJS.eventMarker[e].videoPaused&&(vimeoGAJS.sendEvent(d,"Resumed video"),vimeoGAJS.eventMarker[e].videoResumed=!0):(vimeoGAJS.sendEvent(d,"Started video"),vimeoGAJS.eventMarker[e].videoPlayed=!0);break;case"pause":vimeoGAJS.onPause(d);break;case"finish":vimeoGAJS.eventMarker[e].videoCompleted||(vimeoGAJS.sendEvent(d,"Completed video"),vimeoGAJS.eventMarker[e].videoCompleted=!0)}}},getLabel:function(a){var b;a.attr("src").indexOf("?")>-1&&(b=a.attr("src").split("?")[0]);var c=b;return a.data("title")?c+=" ("+a.data("title")+")":a.attr("title")&&(c+=" ("+a.attr("title")+")"),c},post:function(b,c,d){var e={method:b};c&&(e.value=c);var f;a(d).attr("src").indexOf("?")>-1&&(f=a(d).attr("src").split("?")[0]),d.contentWindow.postMessage(JSON.stringify(e),f)},onReady:function(){a.each(vimeoGAJS.iframes,function(a,b){vimeoGAJS.post("addEventListener","play",b),vimeoGAJS.post("addEventListener","seek",b),vimeoGAJS.post("addEventListener","pause",b),vimeoGAJS.post("addEventListener","finish",b),vimeoGAJS.post("addEventListener","playProgress",b)})},onPause:function(a){var b=a.attr("id");vimeoGAJS.eventMarker[b].timePercentComplete<99&&!vimeoGAJS.eventMarker[b].videoPaused&&(vimeoGAJS.sendEvent(a,"Paused video"),vimeoGAJS.eventMarker[b].videoPaused=!0)},onPlayProgress:function(a,b){var c,d=b.attr("id");vimeoGAJS.eventMarker[d].timePercentComplete=Math.round(100*a.percent),b.data("progress")&&(vimeoGAJS.eventMarker[d].timePercentComplete>24&&!vimeoGAJS.eventMarker[d].progress25&&(c="Played video: 25%",vimeoGAJS.eventMarker[d].progress25=!0),vimeoGAJS.eventMarker[d].timePercentComplete>49&&!vimeoGAJS.eventMarker[d].progress50&&(c="Played video: 50%",vimeoGAJS.eventMarker[d].progress50=!0),vimeoGAJS.eventMarker[d].timePercentComplete>74&&!vimeoGAJS.eventMarker[d].progress75&&(c="Played video: 75%",vimeoGAJS.eventMarker[d].progress75=!0),c&&vimeoGAJS.sendEvent(b,c))},sendEvent:function(a,b){var c=a.data("bounce"),d=vimeoGAJS.getLabel(a);switch(vimeoGAJS.gaTracker){case"gtm":dataLayer.push({event:"Vimeo",eventCategory:"Vimeo",eventAction:b,eventLabel:d,eventValue:void 0,eventNonInteraction:!c});break;case"ua":ga("send","event","Vimeo",b,d,void 0,{nonInteraction:c?0:1});break;case"ga":_gaq.push(["_trackEvent","Vimeo",b,d,void 0,!c])}}},vimeoGAJS.init()}(jQuery);